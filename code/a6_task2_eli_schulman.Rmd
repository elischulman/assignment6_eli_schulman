---
title: "Is Environmentalism Bipartisan?"
author: "Eli Schulman"
output: html_document
---

***Introduction: *** This analysis looks to determine if there is an association between one's self-identification as an environmentalist and their political affiliation. The Chi-Square test uses survey responses of conservation donors. 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(tidyverse)
library(here)
library(janitor)
library(broom)
library(kableExtra)
```


```{r}
# read in original data
surveys <- read_csv(here("data","conservation_survey.csv")) 

# create simple df for just liberals and conservatives
surveys_clean <- surveys %>% 
  clean_names() %>% 
  select(env_id, pol_or) %>% 
  mutate(affiliation = case_when(
    pol_or %in% c(1:3) ~ "Conservative",
    pol_or %in% c(5:7) ~ "Liberal"
  )) %>% 
  mutate(env_id = case_when(
    env_id == 1 ~ "Yes",
    env_id == 2 ~ "No",
    env_id == 3 ~ "Unsure"
  )) %>% 
  drop_na(affiliation)
```

```{r}
# create table to display affiliation and environmental concern
pol_env <- surveys_clean %>% 
# select columns
  tabyl(affiliation, env_id) %>% 
# change counts to percentages and change formatting
  adorn_percentages() %>% 
  adorn_pct_formatting(digits = 0) %>% 
# include counts along with percentages
  adorn_ns()

# reoder the column headers of the table
pol_env <- pol_env[, c(1, 4, 2, 3)]

kable(pol_env,
      caption = str_wrap("Association Between Political Affiliation and Self-Identification as an Environmentalist"),
      col = c("Affiliation", "Yes", "No", "Unsure")) %>% 
  kable_styling(full_width = FALSE)
```

```{r}
# create contingency table for counts of environmentalists and political affiliation
pol_env_counts <- surveys_clean %>% 
  tabyl(affiliation, env_id) %>% 
  column_to_rownames(var = "affiliation")

# run chi-square test
pol_env_x2 <- chisq.test(pol_env_counts)

#use broom::tidy to make df of chi-square results
pol_env_tidy <- tidy(pol_env_x2)
```

***Interpretation: *** There is a significant association between one's political party and whether they consider themselves an environmentalist ($\chi$^2^(`r pol_env_tidy$parameter`) = `r round(pol_env_tidy$statistic, 2)`. *p* `r ifelse(pol_env_tidy$p.value < .001, paste("< .001"), paste(" = ", pol_env_tidy$p.value))`). Of conservatives surveyed, only `r pol_env[1,2]` self-identified as environmentalists, while `r pol_env[1,3]` responded that they were not environmentalists and `r pol_env[1,4]` responded as "unsure". Alternatively, of liberals surveyed, `r pol_env[2,2]` self-identified as environmentalists, while `r pol_env[2,3]` and `r pol_env[2,4]` responded as "no" or "unsure" to the question.

***Data citation: *** Andrews Forest LTER Site and C. Batavia. 2019. Influences on charitable giving for conservation: Online survey data of 1,331 respondents across the US, August 2017 ver 3. Environmental Data Initiative. https://doi.org/10.6073/pasta/926e6270e324a1322a900da14d38b96c












